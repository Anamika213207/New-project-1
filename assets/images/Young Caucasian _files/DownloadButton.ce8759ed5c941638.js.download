"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[64743],{50763:(e,t,a)=>{a.r(t),a.d(t,{DownloadButton:()=>g,useStyles:()=>w});var r=a(406029),s=a(464839),n=a(513372),i=a(727326),o=a(813631),l=a(485650),c=a(532850),d=a(808059),u=a(670283),m=a(236599),h=a(377981),p=a(455729);let w=(0,a(807703).n9)()(e=>{let{tokens:{spacing:t}}=e;return{downloadButtonCTA:{marginTop:t.m,marginLeft:t.m,marginRight:t.m}}}),g=e=>{let{asset:t,clickAnalyticsLabel:a=i.lnH,clickAnalyticsLabelMap:g,enhancedStateId:f,label:_,orderFlow:v,product:y,productNameStateId:b,selectedSizeStateId:A,setStateOnClick:k,actions:R}=e,{classes:P}=w(),S=(0,h.h)(),{setStates:z}=(0,d.h6)(),E=(0,d.Cw)(f),C=(0,d.Cw)(A),I=(0,d.Cw)(b??""),T=o.xu[t.type],O=E?l.PtZ[T]:l.or1[T];(0,p.useEffect)(()=>{R?.viewed&&S({actionName:R.viewed})},[]);let x=(0,u.T)(),D={orderFlow:v,productType:c.PZ,asset:t,productOverride:y,shouldForceAsset:!0,assetSize:C,license:O},{getCreateOrderHandler:N,isCreateOrderInProgress:B,createOrderHandlerLoading:$}=(0,m.X)(D),G=B||$;return(0,r.jsxs)(n.$n,{"aria-label":_,disabled:G,variant:"contained",color:"secondary",onClick:()=>{let{isEligibleForCon64AnonymousCheckoutExperiment:e}=x(),{createOrderHandler:t}=N({isEligibleForAnonCheckout:e});e?t():z(k),R?.clicked&&S({actionName:R.clicked,customAttributes:{selectedPlan:y?.name||I,selectedLicense:O}})},className:P.downloadButtonCTA,labelTrack:g?.[y?.name||I]||a,children:[B&&(0,r.jsx)(s.A,{color:"inherit",size:24,style:{position:"absolute"}}),_]})}},82078:(e,t,a)=>{a.d(t,{$:()=>m});var r=a(727326),s=a(629749),n=a(581298),i=a(573923),o=a(559044),l=a(498848),c=a(377981),d=a(586694),u=a(455729);let m=()=>{let{analytics:e}=(0,d.pn)(),{locale:t}=(0,n.Y)(),{emitEditProductAnalyticsEvent:a}=(0,s.v)(),{getSearchContext:m}=(0,l.J)(),h=(0,c.h)();return(0,u.useCallback)(s=>{let{assets:n=[],audioContext:l,eventLabel:c,licenseId:d,isRedownload:u,isQuickDownload:p,isPaid:w,isComp:g,pageSection:f,listId:_}=s,v=n[0]??{},y=c||g&&r.z3l||void 0,b=(0,o.yg)(v)||(0,o.f0)(v);e.productDownloaded({products:n.map(e=>(0,i.Un)({asset:e,shouldGetSearchContextFromAsset:!0,licenseId:d,pageSection:f})),download_context:(0,i.qn)({asset:v,isComp:g,isPaid:w,isQuickDownload:p,isRedownload:u,language:t}),eventLabel:y,list_id:_??"",search_context:m(v),...l&&{audio_context:{...l}}}),a("license"),h({actionName:`Successful ${u?"redownload":"download"}`,customAttributes:{assetType:b}})},[e,t,m,a,h])}},116659:(e,t,a)=>{a.d(t,{A:()=>n,W:()=>s});var r=a(813631);let s=e=>!!(e&&e.isUpload),n=e=>!!(e&&e.type===r._g)},116835:(e,t,a)=>{a.d(t,{Rj:()=>v,og:()=>C});var r=a(487519),s=a(392684),n=a(532598),i=a(338436),o=a(813631),l=a(669670),c=a(345307),d=a(485650),u=a(722442),m=a(559044),h=a(402463),p=a(531950),w=a(884378),g=a(293115),f=a(531648);let _=e=>{let{asset:t}=e,{angle:a,selectedFormatType:r,selectedShadowsOption:o}=t;return{angle:a||t?.metadata?.cart?.angle||s.R,content_size:i.kP,...r===n.OA&&{include_shadows:"on"===o}}},v=e=>{let{asset:t}=e;return t?.metadata?.cart?.sizes||t.sizes},y=async e=>{let{asset:t}=e;if(t?.metadata?.cart&&!t.metadata.cart.sizes){let e=(0,m.Kx)(t),a={id:t.id};return e&&(a.channel=l.H6,a.content_provider=c.Au),(await p.Bn.get((0,r.yb)({queryParams:a}).formattedUrl).then(e=>{let{data:t}=e;return(0,w.A)(t)})).sizes}return v({asset:t})},b=e=>{let{asset:t,is3dObject:a,isRexEditorial:r,selectedAssetSize:s}=e;return t.licenseAsJpeg||t.metadata?.cart?.licenseAsJpeg?"jpeg":a&&t.selectedFormatType?"3dByFormat":a&&t.metadata?.cart?.size?"3dBySize":h.N[s]?"comped":r?"rexEditorial":"default"},A=e=>{let{asset:t,licenseStrategy:a,selectedAssetSize:r,sizesToUseArray:s}=e,o=(()=>{switch(a){case"jpeg":return s.find(e=>{let{format:t}=e;return t===n.kr});case"3dByFormat":return s.find(e=>{let{format:a}=e;return a===t.selectedFormatType});case"3dBySize":return;case"comped":return(0,u.z6)({sizes:s,compSizeImage:r});default:return(0,u.hp)(s)}})(),l=o?.format||t.metadata?.cart?.format;switch(a){case"rexEditorial":return{size:i.mx,format:l};case"3dByFormat":{let[e]=o.name.split("_");return{size:e,format:l}}case"3dBySize":return{size:t?.metadata?.cart?.size,format:l};default:return{size:h.PS[(0,g.C)(o.name)].downloadName,format:l}}},k=e=>{let{selectedAssetSize:t,asset:a}=e,r=v({asset:a}),s=(0,m.$9)(a),n=(0,m.R1)(a),o=n?_({asset:a,selectedAssetSize:t,sizesToUse:r}):{};if(!r&&a?.metadata?.cart?.size&&a?.metadata?.cart?.format)return{content_size:s?i.mx:a.metadata.cart.size,content_format:a.metadata.cart.format,...o};let l=Object.values(r),c=b({asset:a,is3dObject:n,isRexEditorial:s,selectedAssetSize:t}),{size:d,format:u}=A({asset:a,licenseStrategy:c,selectedAssetSize:t,sizesToUseArray:l});return{content_size:d,content_format:u,...o}},R=e=>{let{map:t,licenseName:a}=e,r=t[a];return r===i.Fo?i.TR:r},P=e=>{let{asset:t,licenseName:a,isVideoComp:r,selectedAssetSize:s,sizes:n}=e,i=(0,m.$9)(t),o=(0,m.y8)(t),l=(0,m.s$)({sizes:Object.values(n)});return!r&&l?R({map:h._u,licenseName:a}):r||a===d.eNn||i||o?!s||i||o?(0,u.fk)({sizes:n}):h.w4[s]:R({map:h.w4,licenseName:a})},S=async e=>{let{asset:t,licenseName:a,isVideoComp:r,selectedAssetSize:s}=e,n=await y({asset:t}),o=P({asset:t,licenseName:a,isVideoComp:r,selectedAssetSize:s,sizes:n}),l=(0,m.$9)(t),c=Object.values(n).find(e=>{let{resolution:t}=e;return h.KH[t?.toLowerCase()]===o});return{content_size:l?i.mx:o,content_format:c?.format}},z=e=>{let t,{format:a,selectedAssetSize:r}=e;switch(r){case"stereo":t=i.GD;break;case"5.1":t=i.eC;break;default:t=i.LM}return{content_size:t,content_format:a===n.nz?n.nz:n.D1}},E=async e=>{let{asset:t,licenseName:a,isVideoComp:r,selectedAssetSize:s,format:n}=e,l=(0,f.ZC)({asset:t});switch((0,m.Kx)(t)&&(l=o.SL),l){case o.G_:case o.SL:return await S({asset:t,licenseName:a,isVideoComp:r,selectedAssetSize:s});case o.FY:return{content_size:i.Rf,content_format:o.FY};case o.M9:return z({selectedAssetSize:s,format:n});default:return k({selectedAssetSize:s,asset:t})}},C=async e=>{let{licenseName:t,selectedAssetSize:a,asset:r,isVideoComp:s,format:n}=e,i=(0,f.ZC)({asset:r}),o=r.id.toString();return{content_id:o,content_type:(0,f.Uw)({assetType:i,assetId:o}),...await E({asset:r,licenseName:t,isVideoComp:s,selectedAssetSize:a,format:n})}}},157535:(e,t,a)=>{a.d(t,{j:()=>i});var r=a(461266),s=a(455729);let n={applyCanvasViewed:r.lQ,applyToolAnalytics:r.lQ,emitEditProductAnalyticsEvent:r.p5,setAnalyticsStatePartial:r.lQ},i=(0,s.createContext)(n)},193114:(e,t,a)=>{a.d(t,{i:()=>n});var r=a(559044),s=a(184905);let n=e=>{let{asset:t}=e,a=(0,s.H)();return(0,r.sY)(t??{})&&a}},296751:(e,t,a)=>{a.d(t,{JU:()=>u,R5:()=>m,rd:()=>l,v5:()=>o});var r=a(813631),s=a(754725),n=a(946887);let i=e=>{let{cookies:t,cookieName:a}=e;return t?.[a]},o=function(){let{CookiesRef:e=n.A}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i({cookies:e.get(),cookieName:s.Gz})||""},l=function(){let{cookies:e=n.A.get()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i({cookies:e,cookieName:s.Nd})===s.vp},c=e=>{let{assetType:t,isImageType:a,isEditorialType:s,isRecommendedImageType:n}=e;return a?r.W1:s?r.uH:n?r.W1:t},d={expires:7,sameSite:"strict"},u=e=>{let{assetType:t,isImageType:a,isEditorialType:r,isRecommendedImageType:i}=e,l=o(),u=c({assetType:t,isImageType:a,isEditorialType:r,isRecommendedImageType:i});return u!==l&&(n.A.set(s.Gz,u,d),!0)},m=function(){let{CookiesRef:e=n.A}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.remove(s.Gz,d)}},307859:(e,t,a)=>{a.d(t,{H:()=>l});var r=a(406029),s=a(513372),n=a(97959),i=a(52492);let o=(0,a(807703).n9)()(e=>{let{breakpoints:t,tokens:{spacing:a,color:r},palette:{secondary:s}}=e;return{root:{padding:`${a.s} ${a.base}`,[t.up("lg")]:{padding:`${a.s} ${a.xl}`},whiteSpace:"nowrap"},redBackgroundIcon:{padding:a.s,marginLeft:a.xxs,color:r.white,backgroundColor:s.main,"&:hover":{backgroundColor:s.dark}}}}),l=e=>{let{clickAnalyticsLabel:t="",color:a="secondary",isOverlay:l=!1,label:c,onClick:d,shouldUseIcon:u=!1,showGlobalProgressBar:m=!0,variant:h="contained"}=e,{classes:p}=o();return u?(0,r.jsx)(n.K,{className:l?p.redBackgroundIcon:p.root,onClick:d,"aria-label":c,clickTrack:t,size:"large",showGlobalProgressBar:m,children:(0,r.jsx)(i.Download,{})}):(0,r.jsx)(s.$n,{className:p.root,color:a,variant:h,fullWidth:!0,onClick:d,clickTrack:t,"aria-label":c,showGlobalProgressBar:m,"data-automation":"AssetDownloadCta_DownloadButton",children:c})}},497604:(e,t,a)=>{a.d(t,{e:()=>d,s:()=>c});var r=a(392684),s=a(532598),n=a(813631),i=a(531648),o=a(722442),l=a(559044);let c=e=>{let{asset:t}=e;switch((0,l.f0)(t)){case n.G_:return(0,o.ch)(Object.values(t.sizes));case n.W1:default:return(0,o.hp)(t?.sizes&&Object.values(t.sizes))}},d=e=>{let t,a,{asset:c,selectedAssetSize:d,selectedShadowsOption:u,isTitleNeeded:m=!1}=e,h=(0,i.ZC)({asset:c}),p=(0,l.R1)(c);(0,l.Kx)(c)&&(h=n.SL);let w=c.id.toString(),g=(0,i.Uw)({assetType:h,assetId:w});switch(h){case n.G_:case n.SL:t=d||(0,o.zS)({sizes:c.sizes})?.[0],a=t?.resolution;break;case n.FY:case n.M9:case n.on:t=d,a=t?.resolution;break;case n.vo:case n.kc:default:t=d||(0,o.hp)(c.sizes),[a]=t.name.split("_")}return{content_id:w,content_type:g,content_size:a,content_format:t?.format,...m?{content_title:c?.title}:{},...p?{...d.format===s.OA&&{include_shadows:"on"===u},angle:c?.angle||r.R}:{}}}},530376:(e,t,a)=>{a.d(t,{I2:()=>u,YW:()=>l,rc:()=>c});var r=a(377981),s=a(345622),n=a(119349),i=a(981278),o=a(455729),l=function(e){return e.HOMEPAGE="GHP",e.RESULTS="GRP",e.CHATBOT="CHATBOT",e}({}),c=function(e){return e.PAGE="page loaded",e.GENERATE="generate text_to_image",e.MAGIC_BRUSH="generate inpainted image",e.SMART_EDIT="generate inpainted image from prompt",e.VARIATION="generate variation",e.ZOOM_OUT="generate zoom_out",e.VIDEO="generate video",e.DOWNLOAD="download",e.COMP="comp",e.ADD_TO_CART="add_to_cart",e.LICENSED="licensed",e.REDOWNLOAD="redownloaded",e.NEW_MESSAGE="chat message sent",e}({});let d={[(0,s.ll)()[0]]:"GHP",[s.ns]:"GRP",[s.AR]:"CHATBOT"},u=()=>{let{pathname:e}=(0,i.useRouter)(),t=(0,r.h)();return(0,o.useCallback)(a=>{let{action:r,page:s,customAttributes:i,asset:o,generationType:l}=a,c=(s??d[(0,n.YT)(e)])||"";t({actionName:`Generate - ${c} - ${r}`,customAttributes:{...i,...o&&{assetId:o.id},...l&&{generationType:l}}})},[t,e])}},531648:(e,t,a)=>{a.d(t,{Ic:()=>d,Qk:()=>l,Uw:()=>i,ZC:()=>o,xB:()=>c});var r=a(813631),s=a(485650),n=a(559044);let i=e=>{let{assetId:t,assetType:a}=e;if((0,n.$9)({id:t}))return r.uH;switch(a){case r.W1:case r.no:case r.kc:case r.m$:return r.vo;case r.BI:return r.G_;case r.on:case r.pS:return r.FY;case r.M9:return r.M9;default:return a}},o=e=>{let{asset:t}=e;if(t?.image?.isVector)return r.kc;if((0,n.$9)(t))return r.uH;let a=t.imageType||t.itemType||t.type;switch(a){case r.KB:case r.$E:case r.no:return r.W1;case r.BI:return r.G_;case r.pS:return r.FY;case r.M9:return r.M9;default:return a}},l=e=>{let{asset:t}=e;if((0,n.O6)(t))return r.uH;if((0,n.Kx)(t))return r.rr;let a=t.imageType||t.itemType||t.type;switch(a){case r.kc:case r.vo:case r.KB:case r.$E:case r.no:return r.W1;case r.BI:return r.G_;case r.pS:return r.FY;case r.M9:return r.M9;default:return a}},c=e=>{let{asset:t}=e;if((0,n.O6)(t))return r.oh;if((0,n.Kx)(t))return r.SL;let a=t.imageType||t.itemType||t.type;switch(a){case r.kc:case r.vo:case r.KB:case r.$E:case r.no:return r.W1;case r.BI:return r.G_;case r.pS:case r.on:return r.FY;case r.M9:return r.M9;default:return a}},d=e=>{let t=c({asset:e.mediaItem});return e.licenseName===s.H8E[t]}},533576:(e,t,a)=>{a.d(t,{g:()=>h});var r=a(338436),s=a(705992),n=a(485650),i=a(828426),o=a(639424),l=a(17563),c=a(840470),d=a(82281);let{publicRuntimeConfig:{_app:{name:u,version:m}}}=a.n(d)()();class h{constructor(e,t="peacock"){this.downloadPromises=[],this.config=e,this.delayedDependencies=a.e(3367).then(a.bind(a,403367)),this.configStreamSaver(),this.APP_NAME=t,this.startingPromises=this.createWaitingPromises(e),this.downloadProcess=Promise.all(this.startingPromises).then(()=>Promise.all(this.downloadPromises)).then(t=>{let a=[].concat(...t);this.createAndDownloadZip(a,e.finalZipName)})}async restartDownload(e,t,a,r){return this.downloadPromises=[],this.resolveUrl(e,t,a,r),Promise.all(this.downloadPromises).then(e=>{let t=[].concat(...e);return this.createAndDownloadZip(t,this.config.finalZipName)})}async configStreamSaver(){let{streamSaver:e}=await this.delayedDependencies,t=(window.location.hostname||"localhost").includes("localhost"),a="";t&&(a="https://www.qa.shutterstock.com"),e.mitm=`${a}/static/mitm/mitm.html`}requestUnwatermarkedGeneratedAsset(e){let t=`query download {
      generatedAssetOriginalSource(assetId: "${e}") {
        data {
          src
        }
      }
    }`;return(0,c.request)({url:"/napi/graphql",document:t,variables:{},requestHeaders:{[s.E3]:u,[s.Jw]:m,[s.ef]:this.APP_NAME||"peacock"}}).then(e=>e.generatedAssetOriginalSource.data.src)}createWaitingPromises(e){let t=[new Promise((e,t)=>{this.editsResolver=e,this.editsRejecter=t})];if(e.embedImage){let e=new Promise((e,t)=>{this.embedResolver=e,this.embedRejecter=t});t.push(e)}return t}async generateEpsUrl(e){let t,a=n.NOy;(t=e?.[0].asset?(0,i.I)({assetsInfo:e}):{required_cookies:"",content:[{content_id:e[0].contentId,content_type:e[0].contentType,content_size:e[0].contentSize,content_format:e[0].contentFormat,license_name:e[0].licenseName,show_modal:!0}]}).content[0].content_size=l.XJ.Vector.toLocaleLowerCase(),t.content[0].content_format=l.vz.Eps.toLocaleLowerCase();let{downloadUrl:r}=await (0,o.Dt)({downloadPayload:t,licenseeIdentifier:a});return r}async resolveUrl(e,t,a,s){let n=e.sizes?e.sizes:{},i=r.hq in n?await this.generateEpsUrl(s):void 0;e.id===this.config.editsImage&&(this.downloadPromises.push(this.createEditsResponses(t,e.id,a)),i&&this.downloadPromises.push(this.createEmbedResponses(i)),this.editsResolver(t)),e.id===this.config.embedImage&&this.embedResolver&&(this.config.editsImage.includes("asset-generation")&&this.requestUnwatermarkedGeneratedAsset(this.config.editsImage).then(e=>{this.downloadPromises.push(this.createEditsResponses(e,this.config.editsImage,a)),this.editsResolver(e)}),this.downloadPromises.push(this.createEmbedResponses(t)),i&&this.downloadPromises.push(this.createEmbedResponses(i)),this.embedResolver(t))}resolveWatermarkedUrl(e,t,a){if(e===this.config.editsImage&&(this.downloadPromises.push(this.createEditsResponses(t,e,a)),this.editsResolver(t)),e===this.config.embedImage&&this.embedResolver){if(this.config.editsImage.includes("asset-generation")){let e=this.config.imageEdits?.src;e&&(this.downloadPromises.push(this.createEditsResponses(e,this.config.editsImage,a)),this.editsResolver(e))}this.downloadPromises.push(this.createEmbedResponses(t)),this.embedResolver(t)}}async createEmbedResponses(e){return[await fetch(e)]}async createEditsResponses(e){return[await fetch(e)]}async createAndDownloadZip(e,t){let{streamSaver:a,downloadZip:r}=await this.delayedDependencies,s=a.createWriteStream(t),n=r(e);n.body?.pipeTo(s)}}},590891:(e,t,a)=>{a.r(t),a.d(t,{DownloadButton:()=>v});var r=a(406029),s=a(315888),n=a(813631),i=a(630552),o=a(882431),l=a(559044),c=a(262593),d=a(476539),u=a(193114),m=a(377981),h=a(323982),p=a(609380),w=a(235757),g=a(981278),f=a(455729),_=a(307859);let v=e=>{let{asset:t,clickAnalyticsLabel:a,color:v,isOverlay:y,label:b,onClickHandlerOverride:A=null,productToSellInOverlay:k=s.hl,shouldUseDownloadIcon:R=!1,variant:P}=e,{asPath:S}=(0,g.useRouter)(),z=(0,m.h)(),E=(0,u.i)({asset:t}),C=(0,l.$9)(t),[,I]=(0,h.p)(t)||[],T={landing_page:C?`${S}?showDrawerOnLoad=true`:(0,c.$)({orderFlow:o.Y.LO_ASSET_OVERLAY,asset:t,productId:E?s.uyi:k,existingUserRedirect:I}),...t?.type===n.no&&{assetType:t?.type,imageId:t?.id}},O=(0,d.z)({query:T}),x=(0,f.useCallback)(()=>{z({actionName:i.mq.IMAGE_ADP_DOWNLOAD_CTA_CLICKED,customAttributes:{component:"DownloadButton"}}),O()},[z,O]),D=t&&(0,w.GT)(t)&&t?.videoRenderUrl;return(0,r.jsx)(_.H,{label:b,color:v,variant:P,onClick:A??(D?()=>{t&&(0,w.GT)(t)&&(0,p.I)(t)}:x),clickAnalyticsLabel:a,shouldUseIcon:R,isOverlay:y})}},609380:(e,t,a)=>{a.d(t,{I:()=>n});var r=a(639424);let s={"video/mp4":".mp4","image/gif":".gif"},n=async e=>{let t=await fetch(`${e.videoRenderUrl}?doc_id=${e.id}`,{mode:"cors",credentials:"include"}).then(e=>e.blob()),a=s[t.type]||"";(0,r.Bx)(URL.createObjectURL(t),{name:`${e.title}${a}`})}},614304:(e,t,a)=>{a.d(t,{S:()=>o});var r=a(926114),s=a(648973),n=a(515729),i=a(568880);let o=()=>{let{enqueueSnackbar:e}=(0,n.d)(),{t}=(0,i.Bd)(r.mRw);return{enqueueGenericError:a=>{e({alertSeverity:s.ff,error:a,message:t("notifications:label_generic_failure"),reason:"generic error"})}}}},629749:(e,t,a)=>{a.d(t,{v:()=>n});var r=a(455729),s=a(157535);let n=()=>(0,r.useContext)(s.j)},639424:(e,t,a)=>{a.d(t,{fX:()=>_,eG:()=>v,T9:()=>P,Bx:()=>f,Zj:()=>k,Dt:()=>b,G$:()=>y,lL:()=>R});var r=a(940252);let s=e=>{let{urlParams:t={},queryParams:a={}}=e,s=`/bundle/${t.filename}`,n={...a};return{url:s,defaultParams:n,formattedUrl:(0,r.format)({pathname:s,query:n})}};var n=a(487519),i=a(532598),o=a(338436),l=a(813631),c=a(669670),d=a(485650),u=a(116835),m=a(722442),h=a(559044),p=a(957160),w=a(531950),g=a(296751);let f=function(e){let{name:t,target:a="_self"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=document.createElement("a");r.setAttribute("data-automation","FeatureDownload_utils_link"),r.style.display="none",r.href=e,r.target=a,r.download=t||e,document.body.appendChild(r),r.click(),(0,g.rd)()||document.body.removeChild(r)},_=async e=>{let{downloadBundlePayload:t}=e,a=s({urlParams:{filename:t.bundleFilename}}).formattedUrl,{public_url:r}=(await w.a8.post(a,t.content)).data;return r},v=async e=>{let{downloadZip:t}=await a.e(17555).then(a.bind(a,717555)),r=await Promise.all(e.map(async e=>{let{filename:t,url:a}=e,r=await fetch(a);return{name:t,input:await r.blob()}})),s=await t(r).blob();return URL.createObjectURL(s)},y=e=>{let{licensedContent:t,supplementalUrlType:a}=e,{downloadUrl:r,supplementalUrls:s}=t[0];if(s?.length&&a){let{url:e=r}=s.find(e=>{let{type:t}=e;return t===a})||{};return e}return r},b=async e=>{let{downloadPayload:t,supplementalUrlType:a,licenseeIdentifier:r}=e,s=(0,n.Gt)({urlParams:{licenseeIdentifier:r}}).formattedUrl,{data:{meta:{licensedContent:i}}}=await w.Bn.post(s,t);return{downloadUrl:y({licensedContent:i,supplementalUrlType:a}),licensedContent:i}},A=e=>{let{existingAssetLicenses:t,contentType:a,licenseName:r,subscriptions:s}=e;switch(a){case l.G_:{let e=(0,p.d)({existingAssetLicenses:t,subscriptions:[...s?.videoSubscriptions??[],...s?.videoCompSubscriptions??[]],licenseName:r});return e?.redeemableFor||r}case l.FY:return r||d.nYH;case l.M9:return r||d.X0R;case l.vo:default:return r}},k=async e=>{let{assets:t,existingAssetLicenses:a,format:r,selectedAssetSize:s,subscriptions:n}=e,d=t.map(async e=>{let t=(0,m.R9)({asset:e}),d=await (0,u.og)({asset:e,licenseName:e.licenseId,selectedAssetSize:s});return{...d,...t===l.M9&&{override_filename:`${c.wT}_${e.id}.${r||d.content_format}`},...(0,h.R1)(e)&&{content_provider:"pixelsquid-media",content_size:o.kP,...e.selectedFormatType===i.OA&&{include_shadows:"on"===e.selectedShadowsOption}},license_name:n?A({existingAssetLicenses:a,contentType:t,licenseName:e.licenseId,subscriptions:n}):e.licenseId,show_modal:!0}});return{required_cookies:"",content:await Promise.all(d)}},R=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e&&e.id&&(e.title||e.description)&&e.type&&window.localStorage.setItem("sstk_ent_asset_preview",JSON.stringify({id:e.id,title:e.title||e.description,thumb:e.src||e.previewImageUrl||"",video:e.previewVideoUrls,url:e.link,type:(0,h.f0)(e),isRex:e.isRexEditorial}))},P=e=>{let t;return requestAnimationFrame?function(){for(var a=arguments.length,r=Array(a),s=0;s<a;s++)r[s]=arguments[s];t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{e(...r)})}:e}},808059:(e,t,a)=>{a.d(t,{kN:()=>c,h6:()=>m,Cw:()=>u});var r=a(406029),s=a(467889);let n=e=>(0,s.y)()(t=>({...e,actions:{setStates:e=>t(t=>({...t,...e})),setState:(e,a)=>t(t=>({...t,[e]:a}))}}));var i=a(455729),o=a(565317);let l=(0,i.createContext)(null),c=e=>{let{children:t,initialState:a}=e,[s]=(0,i.useState)(()=>n(a));return(0,r.jsx)(l.Provider,{value:s,children:t})},d=e=>{let t=(0,i.useContext)(l);if(!t)throw Error("useConversionPanelStore must be used within CounterStoreProvider");return(0,o.P)(t,e)},u=e=>d(t=>t[e]),m=()=>d(e=>e.actions)},828426:(e,t,a)=>{a.d(t,{I:()=>p,p:()=>w});var r=a(926114),s=a(648973),n=a(485650),i=a(360662),o=a(497604),l=a(559044),c=a(82078),d=a(639424),u=a(461266),m=a(568880),h=a(455729);let p=e=>{let{assetsInfo:t=[]}=e;return{required_cookies:"",content:t.map(e=>{let{asset:t,licenseName:a,selectedAssetSize:r,selectedShadowsOption:s}=e;return{...(0,o.e)({asset:t,selectedAssetSize:r,selectedShadowsOption:s}),license_name:a,show_modal:!0}})}},w=e=>{let{setRedownloadStatus:t=u.lQ,onRedownloadSuccess:a=u.lQ}=e,[o,w]=(0,h.useState)(!1),g=(0,c.$)(),f=(0,i.Q)(),{t:_}=(0,m.Bd)(r.EJ3),v=_("file_name_edited");return{redownloadHandler:(0,h.useCallback)(async e=>{let{assetsInfo:r,isPostDownload:i=!1}=e,{asset:o}=r?.[0]??{};w(!0),t?.({status:"",error:void 0});let c=p({assetsInfo:r}),u=(0,l.OJ)(o),m=(0,l.MO)(o),h=n.NOy;try{let{downloadUrl:e,licensedContent:t}=await (0,d.Dt)({downloadPayload:c,licenseeIdentifier:h});if(a?.({content:t,assetsInfo:r}),!u&&!m)if(g({assets:[o],isComp:!1,isPaid:!1,isQuickDownload:!0,isRedownload:!0}),f?.current&&0!==Object.keys(f.current).length){let{downloader:t}=f.current;i?t?.restartDownload(o,e,v,r):t?.resolveUrl(o,e,v,r)}else(0,d.Bx)(e,{target:"_blank"})}catch(e){t?.({status:s.Nz,error:e})}finally{w(!1)}},[v,f,a,g,t]),isRedownloadInProgress:o}}}}]);
//# sourceMappingURL=DownloadButton.ce8759ed5c941638.js.map